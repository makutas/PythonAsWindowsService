# Python as a Windows service
Launch python executables as a Windows service

# Requirements:
### Pip install:
* pywin32 (windows service management)
* pyinstaller (for creating an executable file in windows)

### Pyinstaller:
To avoid error with win32timezone module pyinstaller should be run like this:

* *pyinstaller --onefile --hidden-import win32timezone YourPythonFile.py*

This will create one executable file with hidden import of win32timezone in your
project /dist directory. The win32timezone error can also be avoided by adding the following: *hiddenimports=['win32timezone']*
  in your YourPythonFile.spec which will be autogenerated after running the pyinstaller.

## Windows command prompt:
You must run windows command prompt from start menu as an administrator to avoid issues with windows services.
When command prompt is run, use the following syntax to enable service:

* *sc create YourServiceName binpath= "Path to your '.exe' file"*

Example: *sc create My_WinService binPath= "C:/Users/JohnDoe/Projects/My_script.exe"*

__Very important to have an empty space after 'binPath=' !!!__

You can also consider adding the *start=auto* argument so that the service will be automatically started.

*sc create My_WinService binPath= "C:/Users/JohnDoe/Projects/My_script.exe" start=auto*

## Sometimes services get stuck....

Sometimes, when service is run, and you stop it after some time, it can get stuck.

However, you can kill the service via command prompt:

* first you can find the process id (PID) by using the *"sc queryex"* command.
* when you know the PID, you can terminate process as follows:

*taskkill /pid "PID" /f* 

Example: *taskkill /pid 1234 /f*